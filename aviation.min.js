function Aviation(e){if(!(this instanceof Aviation))return new Aviation(e);"object"!=typeof e&&(e={strict:!1,caseSensitive:!1});var t=[],n=this,r=document.querySelector(e.contentWrapper||"body"),o=e.onError||function(e){console.error(e)};if(this.on=function(r,o){var a=r,i=o,c=[];if("*"==a&&(a=/^.*$/),o||(i=r,a=/^.*$/),!(a instanceof RegExp)){if(a.constructor==Array||a.constructor==Object){for(var s in a)n.use(a[s],o);return n}a=String(a);var p="",l=document.createElement("a");l.href=a,a=l.pathname,e.strict||(a=a.replace(/\/$/,"")),e.caseSensitive||(p="i"),e.removeFromPath&&(a=a.replace(e.removeFromPath,"")),/\:/.test(a)?(a=a.replace(/\*+/g,"").replace(/:([^\/]+)/g,function(e,t){return c.push(t),"([^\\/]+?)"}),a=new RegExp("^"+a.split("([^\\/]+?)").map(function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}).join("([^\\/]+?)")+"$",p)):a=new RegExp("^"+a.split(/\*+/).map(function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}).join(".*")+"$",p)}return t.push({path:a,keys:c,fn:i}),n},this.use=this.on,this.handle=function(a,s,p){p||(p=a.target);var l="string"==typeof a?a:p?p.getAttribute("href"):a.href?a.href:this.href?this.href:"",h=document.createElement("a");h.href=l;var u=h.pathname;e.strict||(u=u.replace(/\/$/,"")),e.removeFromPath&&(u=u.replace(e.removeFromPath,""));var f=[];for(var d in t){var v=t[d];if(v.path&&v.path.test(u)){var m={},g=u.match(v.path).slice(1);if(v.keys.length)for(var d in g)m[v.keys[d]]=g[d];f.push({fn:v.fn,params:m})}}if(!f.length)return n;a.preventDefault&&a.preventDefault(),u&&"/"===u[0]||(u="/"+(u||""));var y={url:h.href,hostname:h.hostname,path:u,protocol:h.protocol?h.protocol.replace(":",""):null,secure:!1,query:i(h.href),params:{},cookies:c(),aviation:n};"https"==y.protocol&&(y.secure=!0);var R={cookie:function(e,t,n){return n||(n={}),y.cookies[e]=t,void 0===n.maxAge&&void 0===n.expires&&(n.maxAge=2628e3),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+(n.maxAge?";max-age="+encodeURIComponent(n.maxAge):"")+(n.expires?";expires="+encodeURIComponent(n.expires):"")+(n.path?";path="+encodeURIComponent(n.path):";path")+(n.domain?";domain="+encodeURIComponent(n.domain):"")+(n.secure?";secure="+encodeURIComponent(n.secure):"")+(n.sameSite?";samesite="+encodeURIComponent(n.sameSite):""),this},clearCookie:function(e,t){return t.maxAge=-1,this.cookie(e,null,t),delete y.cookies[e],this},location:function(e){var t=!0;return n.handle({href:e,preventDefault:function(){t=!1}}),t&&(window.location=e),this},redirect:function(e){return this.location(e)},page:function(t,n){return"undefined"!=typeof history&&history.pushState&&!1!==e.changeURL&&!0!==s&&history.pushState({url:n||y.url},t,n||y.url),document.querySelector("title").innerText=t,this},html:function(e){return r.innerHTML="",r.append(e),this}},k=function(e){try{if(e)throw e;var t=f[++d];if(!t)return;y.params=t.params;var n=t.fn(y,R,k);n&&n.catch&&n.catch(function(e){o(e,y,R,k)})}catch(e){o(e,y,R,k)}};d=-1;return k(),n},this.loadListener=function(){var t=window.location.href;"file://"==t.substring(0,7)&&(void 0===e.changeURL&&(e.changeURL=!1),t="/"),n.handle(t)},!0!==e.skipOnLoad)for(var a in e.loadEvents&&e.loadEvents.length||(e.loadEvents=["DOMContentLoaded"]),e.loadEvents)document.addEventListener(e.loadEvents[a],this.loadListener);for(var a in this.eventHandler=function(t){var r=!1,o=e.source||"a[href]:not([target='_blank']):not(.skip-aviation)";if(t.path)for(var a in t.path)if(t.path[a]&&t.path[a].matches&&t.path[a].matches(o)){r=t.path[a];break}if(!r&&t.target&&(t.target.matches(o)&&(r=t.target),!r&&t.target.parentNode))for(var i=t.target.parentNode;i;){if(i.matches&&i.matches(o)){r=i;break}i=i.parentNode}r&&n.handle(t,!1,r)},e.events&&e.events.length||(e.events=["click"]),e.events)(e.eventWrapper||document).addEventListener(e.events[a],this.eventHandler);!0!==e.skipPopstate&&!1!==e.changeURL&&window.addEventListener("popstate",function(e){n.handle(e.state.url,!0)},!1);var i=function(e){if(!/\?/.test(e))return{};var t={},n=e.split("?")[1].split("&");for(var r in n){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t},c=function(){var e={},t=document.cookie.split(";");for(var n in t){var r=t[n].split("=");r[0]&&r[1]&&(e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]))}return e}}Aviation.element=function(){var e=arguments,t="div",n=!1;e[0]&&"string"==typeof e[0]&&(t=e[0],delete e[0]),e[1]&&"object"==typeof e[1]&&(n=e[1],delete e[1]);var r=document.createElement(t);if(n){if(n.className&&(n.class=n.className,delete n.className),n.style&&n.style.constructor==Object){for(var o in n.style)r.style[o]=n.style[o];delete n.style}for(var o in n)n[o]&&r.setAttribute(o,n[o])}for(var a in e)e[a]&&(e[a].isAviationElement||(e[a]=String(e[a])),r.append(e[a]));return r.isAviationElement=!0,r},Aviation.safe=function(e){return e?e=String(e).replace(/\&/gi,"&amp;").replace(/\</gi,"&lt;").replace(/\>/gi,"&gt;").replace(/\"/gi,"&quot;").replace(/\'/gi,"&#x27;").replace(/\//gi,"&#x2F;"):""};
